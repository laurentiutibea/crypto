{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"D:\\\\WEB\\\\crypto\\\\client\\\\pages\\\\admin.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from 'react';\nimport _ from \"lodash\";\nimport Layout from \"../components/layout\";\nimport auth from \"../services/authService\";\nimport crypto from \"../services/cryptoService\";\nimport { getUsers } from \"../services/userService\";\nimport { paginate } from \"../utils/paginate\";\nimport DataTable from \"../components/dataTable\";\nimport Pagination from \"../components/pagination\";\n\nvar Admin =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Admin, _Component);\n\n  function Admin() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Admin);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Admin)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      user: {},\n      data: [],\n      pageSize: 7,\n      currentPage: 1,\n      searchQuery: \"\",\n      sortColumn: {\n        path: \"email\",\n        order: \"asc\"\n      },\n      columns: [{\n        path: \"email\",\n        label: \"Email\"\n      }, {\n        path: \"name\",\n        label: \"Name\"\n      }, {\n        key: \"isAdmin\",\n        label: \"Admin\",\n        content: function content(data) {\n          return __jsx(\"select\", {\n            name: \"isAdmin\",\n            className: \"form-control select-w\",\n            onChange: function onChange(e) {\n              return _this.handleChangeBool(e, data);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 27\n            },\n            __self: this\n          }, __jsx(\"option\", {\n            value: data.isAdmin,\n            hidden: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 28\n            },\n            __self: this\n          }, data.isAdmin), __jsx(\"option\", {\n            value: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 29\n            },\n            __self: this\n          }, \"true\"), __jsx(\"option\", {\n            value: false,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 30\n            },\n            __self: this\n          }, \"false\"));\n        }\n      }, {\n        key: \"update\",\n        content: function content(data) {\n          return __jsx(\"button\", {\n            onClick: function onClick() {\n              return _this.doUpdate(data);\n            },\n            className: \"btn btn-warning btn-sm\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 33\n            },\n            __self: this\n          }, \"Update\");\n        }\n      }, {\n        key: \"delete\",\n        content: function content(data) {\n          return __jsx(\"button\", {\n            onClick: function onClick() {\n              return _this.handleDelete(data);\n            },\n            className: \"btn btn-danger btn-sm\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 34\n            },\n            __self: this\n          }, \"Delete\");\n        }\n      }],\n      disabled: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePageChange\", function (page) {\n      _this.setState({\n        currentPage: page\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSearch\", function (query) {\n      _this.setState({\n        searchQuery: query,\n        currentPage: 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSort\", function (sortColumn) {\n      _this.setState({\n        sortColumn: sortColumn\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDelete\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(data) {\n        var originalData, allData;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                originalData = _toConsumableArray(_this.state.data);\n                allData = originalData.filter(function (m) {\n                  return m._id !== data._id;\n                });\n\n                _this.setState({\n                  data: allData\n                });\n\n                _context.prev = 3;\n                _context.next = 6;\n                return deleteUser(data._id);\n\n              case 6:\n                _context.next = 8;\n                return _this.getData();\n\n              case 8:\n                _context.next = 14;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](3);\n                if (_context.t0.response && _context.t0.response.status === 404) toast.error(\"Acest element a fost deja sters.\");\n\n                _this.setState({\n                  data: originalData\n                });\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[3, 10]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChangeBool\", function (e, data) {\n      data[e.target.name] = e.target.value;\n      if (e.target.name === \"isAdmin\" && e.target.value === \"false\") data[\"root\"] = \"false\";\n\n      var allData = _objectSpread({}, _this.state.data);\n\n      for (var i = 0; i < allData.length; i++) {\n        if (allData[i]._id === data._id) allData[i] = data;\n      }\n\n      allData = _Object$keys(allData).map(function (key) {\n        return allData[key];\n      });\n\n      _this.setState({\n        data: allData\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"doUpdate\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(data) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                delete data.__v;\n                delete data.email;\n                data.isAdmin = JSON.parse(data.isAdmin);\n                _context2.next = 6;\n                return updateAdmin(data);\n\n              case 6:\n                toast.success(\"Success!\");\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0);\n\n                if (_context2.t0.response && _context2.t0.response.status === 400) {\n                  toast.error(\"Incorrectly data entered!\");\n                }\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 9]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"getPageData\", function () {\n      var _this$state = _this.state,\n          pageSize = _this$state.pageSize,\n          currentPage = _this$state.currentPage,\n          allData = _this$state.data,\n          searchQuery = _this$state.searchQuery,\n          sortColumn = _this$state.sortColumn;\n      var filtered = allData;\n      if (searchQuery) filtered = allData.filter(function (m) {\n        return m.email.toLowerCase().startsWith(searchQuery.toLowerCase());\n      });\n\n      var sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order]);\n\n      var data = paginate(sorted, currentPage, pageSize);\n      return {\n        totalCount: filtered.length,\n        data: data\n      };\n    });\n\n    return _this;\n  }\n\n  _createClass(Admin, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var _this2 = this;\n\n        var user;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                user = auth.getCurrentUser();\n                this.setState({\n                  user: user\n                });\n                _context3.next = 4;\n                return getUsers().then(function (res) {\n                  console.log(res.data);\n\n                  var data = _toConsumableArray(res.data);\n\n                  data.map(function (item) {\n                    return item.isAdmin = item.isAdmin.toString();\n                  });\n\n                  _this2.setState({\n                    data: data\n                  });\n                });\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (process.browser && !auth.getCurrentUser()) {\n        window.location.replace(\"/login\");\n      } else {\n        var _this$state2 = this.state,\n            pageSize = _this$state2.pageSize,\n            currentPage = _this$state2.currentPage,\n            searchQuery = _this$state2.searchQuery,\n            sortColumn = _this$state2.sortColumn;\n\n        var _this$getPageData = this.getPageData(),\n            totalCount = _this$getPageData.totalCount,\n            data = _this$getPageData.data;\n\n        return __jsx(Layout, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, __jsx(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, \"Hello \", this.state.user.name, \"! ADMINNDWIA\"), __jsx(\"div\", {\n          className: \"row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, __jsx(\"div\", {\n          className: \"col-md-3\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, __jsx(\"input\", {\n          type: \"text\",\n          onChange: this.handleSearch,\n          placeholder: \"Search Users...\",\n          value: this.state.searchQuery,\n          name: \"searchQueryCryptocurrencies\",\n          className: \"form-control shadow\",\n          style: {\n            display: \"inline-block\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }), __jsx(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, \"   \", __jsx(\"i\", {\n          className: \"fas fa-search\",\n          style: {\n            display: \"inline-block\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }))), __jsx(\"div\", {\n          className: \"col-md-9\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, !_.isEmpty(this.state.data) ? __jsx(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        }, __jsx(DataTable, {\n          data: data,\n          sortColumn: sortColumn,\n          onDelete: this.handleDelete,\n          onSort: this.handleSort,\n          columns: this.state.columns,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        })) : __jsx(\"img\", {\n          src: require(\"../src/91.gif\"),\n          alt: \"loading\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }), __jsx(Pagination, {\n          itemsCount: totalCount,\n          pageSize: pageSize,\n          currentPage: currentPage,\n          onPageChange: this.handlePageChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }))));\n      }\n    }\n  }]);\n\n  return Admin;\n}(Component);\n\nexport { Admin as default };","map":{"version":3,"sources":["D:/WEB/crypto/client/pages/admin.js"],"names":["React","Component","_","Layout","auth","crypto","getUsers","paginate","DataTable","Pagination","Admin","user","data","pageSize","currentPage","searchQuery","sortColumn","path","order","columns","label","key","content","e","handleChangeBool","isAdmin","doUpdate","handleDelete","disabled","page","setState","query","originalData","state","allData","filter","m","_id","deleteUser","getData","response","status","toast","error","target","name","value","i","length","map","__v","email","JSON","parse","updateAdmin","success","filtered","toLowerCase","startsWith","sorted","orderBy","totalCount","getCurrentUser","then","res","console","log","item","toString","process","browser","window","location","replace","getPageData","handleSearch","display","isEmpty","handleSort","require","handlePageChange"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport _ from \"lodash\";\r\n\r\nimport Layout from \"../components/layout\";\r\nimport auth from \"../services/authService\";\r\nimport crypto from \"../services/cryptoService\";\r\nimport {getUsers} from \"../services/userService\";\r\nimport {paginate} from \"../utils/paginate\";\r\nimport DataTable from \"../components/dataTable\";\r\nimport Pagination from \"../components/pagination\";\r\n\r\nexport default class Admin extends Component{\r\n    state = {\r\n        user: {},\r\n        data: [],\r\n\t\tpageSize: 7,\r\n\t\tcurrentPage: 1,\r\n\t\tsearchQuery: \"\",\r\n\t\tsortColumn: {\r\n\t\t\tpath: \"email\",\r\n\t\t\torder: \"asc\"\r\n\t\t},\r\n\t\tcolumns: [\r\n            {path: \"email\", label: \"Email\"},\r\n            {path: \"name\", label: \"Name\"},\r\n\t\t\t{key: \"isAdmin\", label:\"Admin\", content: data => (\r\n\t\t\t\t\t<select name=\"isAdmin\" className=\"form-control select-w\" onChange={(e) => this.handleChangeBool(e,data)}>\r\n\t\t\t\t\t\t<option value={data.isAdmin} hidden>{data.isAdmin}</option>\r\n\t\t\t\t\t\t<option value={true}>true</option>\r\n\t\t\t\t\t\t<option value={false}>false</option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t)},\r\n\t\t\t{key: \"update\", content: data => ( <button onClick={() => this.doUpdate(data)} className=\"btn btn-warning btn-sm\">Update</button>)},\r\n\t\t\t{key: \"delete\", content: data => ( <button onClick={() => this.handleDelete(data)} className=\"btn btn-danger btn-sm\">Delete</button>)}\r\n\t\t],\r\n\t\tdisabled: false\r\n    }\r\n\r\n    async componentDidMount() {\r\n\t\tconst user = auth.getCurrentUser();\r\n        this.setState({user});\r\n        await getUsers().then(res => {\r\n\t\t\tconsole.log(res.data);\r\n\t\t\tconst data = [...res.data];\r\n\t\t\tdata.map(item => item.isAdmin = item.isAdmin.toString());\r\n\t\t\tthis.setState({data});\r\n\t\t});\r\n    }\r\n\r\n    handlePageChange = page => {\r\n\t\tthis.setState({currentPage:page});\r\n\t};\r\n\r\n\thandleSearch = query => {\r\n\t\tthis.setState({searchQuery: query, currentPage: 1});\r\n\t};\r\n\r\n\thandleSort = sortColumn => {\r\n\t\tthis.setState({sortColumn});\r\n    };\r\n    \r\n    handleDelete = async data => {\r\n\t\tconst originalData = [...this.state.data];\r\n\t\tconst allData = originalData.filter(m => m._id !== data._id);\r\n\t\tthis.setState({data:allData});\r\n\t\ttry {\r\n\t\t\tawait deleteUser(data._id);\r\n\t\t\tawait this.getData();\r\n\t\t}\r\n\t\tcatch(ex){\r\n\t\t\tif(ex.response && ex.response.status === 404) toast.error(\"Acest element a fost deja sters.\");\r\n\r\n\t\t\tthis.setState({data: originalData});\r\n\t\t}\r\n\t};\r\n\r\n    handleChangeBool = (e,data) => {\r\n\t\tdata[e.target.name] = e.target.value;\r\n\t\tif(e.target.name === \"isAdmin\" && e.target.value === \"false\") data[\"root\"] = \"false\";\r\n\t\tlet allData = {...this.state.data};\r\n\t\tfor(let i=0; i<allData.length; i++) if(allData[i]._id === data._id) allData[i] = data;\r\n\t\tallData = Object.keys(allData).map(key => allData[key]);\r\n\t\tthis.setState({data: allData});\r\n\t};\r\n    \r\n    doUpdate = async data => {\r\n\t\ttry{\r\n\t\t\tdelete data.__v;\r\n\t\t\tdelete data.email;\r\n\t\t\tdata.isAdmin = JSON.parse(data.isAdmin);\r\n\t\t\tawait updateAdmin(data);\r\n\t\t\ttoast.success(\"Success!\");\r\n\t\t}\r\n\t\tcatch(ex){\r\n\t\t\tif(ex.response && ex.response.status === 400){\r\n\t\t\t\ttoast.error(\"Incorrectly data entered!\");\r\n\t\t\t}\r\n\t\t}\r\n    };\r\n    \r\n    getPageData = () => {\r\n\t\tconst { pageSize, currentPage, data: allData, searchQuery, sortColumn } = this.state;\r\n\r\n\t\tlet filtered = allData;\r\n\t\tif(searchQuery) filtered = allData.filter(m => m.email.toLowerCase().startsWith(searchQuery.toLowerCase()));\r\n\r\n\t\tconst sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order]);\r\n\r\n\t\tconst data = paginate(sorted, currentPage, pageSize);\r\n\r\n\t\treturn {totalCount: filtered.length, data: data};\r\n\t};\r\n\r\n    render(){\r\n        if(process.browser && !auth.getCurrentUser()) {\r\n            window.location.replace(\"/login\");\r\n        }\r\n        else {\r\n            const { pageSize, currentPage, searchQuery, sortColumn } = this.state;\r\n            const {totalCount, data} = this.getPageData();\r\n        \r\n            return (\r\n                <Layout>\r\n                    <p>Hello {this.state.user.name}! ADMINNDWIA</p>\r\n                    <div className=\"row\">\r\n                        <div className=\"col-md-3\">\r\n                            <input type=\"text\" onChange={this.handleSearch} placeholder=\"Search Users...\" value={this.state.searchQuery} name=\"searchQueryCryptocurrencies\" className=\"form-control shadow\" style={{display: \"inline-block\"}}/>\r\n                            <span>   <i className=\"fas fa-search\" style={{display: \"inline-block\"}}/></span>\r\n                        </div>\r\n                        <div className=\"col-md-9\">\r\n\t\t\t\t\t\t{!_.isEmpty(this.state.data) ? <div>\r\n\t\t\t\t\t\t\t<DataTable\r\n\t\t\t\t\t\t\t\tdata={data}\r\n\t\t\t\t\t\t\t\tsortColumn={sortColumn}\r\n\t\t\t\t\t\t\t\tonDelete={this.handleDelete}\r\n\t\t\t\t\t\t\t\tonSort={this.handleSort}\r\n\t\t\t\t\t\t\t\tcolumns={this.state.columns}\r\n\t\t\t\t\t\t\t/></div>: <img src={require(\"../src/91.gif\")} alt=\"loading\"/>}\r\n\t\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\t\titemsCount={totalCount}\r\n\t\t\t\t\t\t\tpageSize={pageSize}\r\n\t\t\t\t\t\t\tcurrentPage={currentPage}\r\n\t\t\t\t\t\t\tonPageChange={this.handlePageChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n                    </div>\r\n                </Layout>\r\n            );\r\n        }\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}