{"version":3,"file":"static/webpack/static\\development\\pages\\password.js.6993b1c768c79a82f929.hot-update.js","sources":["webpack:///./pages/password.js"],"sourcesContent":["import React, { Component } from 'react';\r\n\r\nimport Layout from \"../components/layout\";\r\nimport cryptoImg from \"../src/crypto-text.png\";\r\nimport {update} from \"../services/userService\";\r\nimport auth from \"../services/authService\";\r\n\r\nexport default class Password extends Component {\r\n    state = {\r\n\t\tuser: {\r\n            _id: \"\", \r\n            email: \"\", \r\n            isAdmin:false, \r\n            name: \"\", \r\n            currentPassword: \"\"\r\n        },\r\n        error: \"\"\r\n\t};\r\n\r\n\tvalidate = () => {\r\n\t\treturn !(this.state.user.password !== \"\" && this.state.user.confirmPassword !== \"\" && this.state.user.currentPassword &&\r\n\t\t\tthis.state.user.password.length >= 5 && this.state.user.confirmPassword.length >= 5 && this.state.user.password.length <= 1024 &&\r\n\t\t\tthis.state.user.confirmPassword.length <= 1024\r\n\t\t);\r\n\t};\r\n\r\n\thandleChange = (e) => {\r\n\t\tconst user = {...this.state.user};\r\n\t\tuser[e.target.name] = e.target.value;\r\n\t\tthis.setState({user});\r\n\t};\r\n\r\n\tdoSubmit = async (e) => {\r\n\t\te.preventDefault();\r\n\t\tif(this.state.user.password === this.state.user.confirmPassword){\r\n\t\t\tif(this.state.user.password.length >= 5){\r\n\t\t\t\tconst {user} = this.state;\r\n\t\t\t\tlet status = 400;\r\n\t\t\t\tawait auth.confirmLogin(user.email, user.currentPassword).then(res => status = res.status).catch(err => status = err.response.status);\r\n\t\t\t\tif(status === 200) {\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tdelete user.confirmPassword;\r\n\t\t\t\t\t\tdelete user.currentPassword;\r\n\t\t\t\t\t\tdelete user.iat;\r\n\t\t\t\t\t\tawait update(user);\r\n\t\t\t\t\t\twindow.location.replace(\"/index\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch(ex){\r\n\t\t\t\t\t\tif(ex.response && ex.response.status === 400){\r\n\t\t\t\t\t\t\tthis.setState({error:\"Incorrectly data entered!\"});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse this.setState({error:\"Authentication error!\"});\r\n\t\t\t}\r\n\t\t\telse this.setState({error:\"Password must have at least 5 characters!\"});\r\n\t\t}\r\n\t\telse this.setState({error:\"Passwords don't match!\"});\r\n    };\r\n\r\n    componentDidMount() {\r\n\t\tconst user = auth.getCurrentUser();\r\n\t\tuser.password = \"\";\r\n\t\tuser.confirmPassword = \"\";\r\n\t\tthis.setState({user});\r\n\t}\r\n    \r\n    render() {\r\n        if(process.browser && !auth.getCurrentUser()) {\r\n            window.location.replace(\"/login\");\r\n        }\r\n        else return (\r\n            <Layout>\r\n                <div className=\"w-50 mx-auto shadow\" style={{marginTop:\"15%\"}}>\r\n                    <div className=\"card-body text-center pt-4\">\r\n                        <img src={cryptoImg}/>\r\n                        <h1 style={{fontFamily: \"Courier New\"}}><strong>Change Password</strong></h1>\r\n\t\t\t\t\t    <hr/>\r\n                        <form onSubmit={this.doSubmit} method=\"POST\" className=\"m-auto\">\r\n                            <div className=\"form-group input\">\r\n                                <input type=\"password\" name=\"currentPassword\" placeholder=\"Current password\" onChange={this.handleChange} className=\"form-control mb-3 mt-2 shadow w-75 mx-auto\"/>\r\n\t\t\t\t\t\t        <input type=\"password\" name=\"password\" placeholder=\"New password\" onChange={this.handleChange} className=\"form-control mb-3 mt-2 shadow w-75 mx-auto\"/>\r\n\t\t\t\t\t\t        <input type=\"password\" name=\"confirmPassword\" placeholder=\"Confirm new password\" onChange={this.handleChange} className=\"form-control mb-3 mt-2 shadow w-75 mx-auto\"/>\r\n                                <button disabled={this.validate()} className=\"btn btn-success mt-2 mb-2\">Change Password</button>\r\n                            </div>\r\n                        </form>\r\n                        <div>\r\n                            <p className=\"text-danger\"><strong>{this.state.error}</strong></p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </Layout>\r\n        )\r\n    }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AARA;AACA;AAUA;AACA;AAIA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AALA;AAAA;AAMA;AAAA;AAAA;AAAA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AASA;AACA;AACA;AAXA;AAAA;AACA;AADA;AAaA;AAbA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAeA;AACA;AAAA;AAAA;AACA;AACA;AAnBA;AAAA;AAAA;AACA;AADA;AAqBA;AAAA;AAAA;AACA;AAtBA;AAAA;AAAA;AACA;AADA;AAuBA;AAAA;AAAA;AACA;AAxBA;AAAA;AAAA;AACA;AADA;AAyBA;AAAA;AAAA;AACA;AA1BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;;;;AAtFA;AACA;;;;;A","sourceRoot":""}